<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
                        http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-4.27.xsd">

    <changeSet id="22-add-category-subcategories" author="system">
        <comment>Добавление подкатегорий для категории "Трубы" из дизайна</comment>

        <!-- Подкатегории для категории "Трубы" (parent_id = 1) -->
        <insert tableName="categories">
            <column name="created_at" valueComputed="NOW()"/>
            <column name="updated_at" valueComputed="NOW()"/>
            <column name="name">PPR трубы</column>
            <column name="description">Полипропиленовые трубы для водоснабжения и отопления</column>
            <column name="parent_id" valueNumeric="1"/>
            <column name="display_order" valueNumeric="1"/>
            <column name="is_active" valueBoolean="true"/>
        </insert>

        <insert tableName="categories">
            <column name="created_at" valueComputed="NOW()"/>
            <column name="updated_at" valueComputed="NOW()"/>
            <column name="name">Трубы для холодной воды</column>
            <column name="description">Трубы для систем холодного водоснабжения</column>
            <column name="parent_id" valueNumeric="1"/>
            <column name="display_order" valueNumeric="2"/>
            <column name="is_active" valueBoolean="true"/>
        </insert>

        <insert tableName="categories">
            <column name="created_at" valueComputed="NOW()"/>
            <column name="updated_at" valueComputed="NOW()"/>
            <column name="name">Трубы для горячей воды</column>
            <column name="description">Трубы для систем горячего водоснабжения</column>
            <column name="parent_id" valueNumeric="1"/>
            <column name="display_order" valueNumeric="3"/>
            <column name="is_active" valueBoolean="true"/>
        </insert>

        <insert tableName="categories">
            <column name="created_at" valueComputed="NOW()"/>
            <column name="updated_at" valueComputed="NOW()"/>
            <column name="name">Канализационные трубы</column>
            <column name="description">Трубы для систем канализации</column>
            <column name="parent_id" valueNumeric="1"/>
            <column name="display_order" valueNumeric="4"/>
            <column name="is_active" valueBoolean="true"/>
        </insert>

        <insert tableName="categories">
            <column name="created_at" valueComputed="NOW()"/>
            <column name="updated_at" valueComputed="NOW()"/>
            <column name="name">Трубы для теплого пола</column>
            <column name="description">Специальные трубы для систем теплого пола</column>
            <column name="parent_id" valueNumeric="1"/>
            <column name="display_order" valueNumeric="5"/>
            <column name="is_active" valueBoolean="true"/>
        </insert>

        <insert tableName="categories">
            <column name="created_at" valueComputed="NOW()"/>
            <column name="updated_at" valueComputed="NOW()"/>
            <column name="name">Гофрированные трубы</column>
            <column name="description">Гофрированные трубы для защиты кабелей и проводки</column>
            <column name="parent_id" valueNumeric="1"/>
            <column name="display_order" valueNumeric="6"/>
            <column name="is_active" valueBoolean="true"/>
        </insert>

        <insert tableName="categories">
            <column name="created_at" valueComputed="NOW()"/>
            <column name="updated_at" valueComputed="NOW()"/>
            <column name="name">Теплоизоляционные трубки</column>
            <column name="description">Трубки для теплоизоляции трубопроводов</column>
            <column name="parent_id" valueNumeric="1"/>
            <column name="display_order" valueNumeric="7"/>
            <column name="is_active" valueBoolean="true"/>
        </insert>

        <!-- Обновляем товары чтобы они были привязаны к подкатегории "PPR трубы" (id = 9) -->
        <update tableName="products">
            <column name="category_id" valueNumeric="9"/>
            <where>id IN (1, 2)</where>
        </update>

        <!-- Добавляем еще товары в подкатегорию PPR трубы для отображения сетки как в дизайне -->
        <insert tableName="products">
            <column name="created_at" valueComputed="NOW()"/>
            <column name="updated_at" valueComputed="NOW()"/>
            <column name="name">Труба PPR PN20 SDR6 20x3,4 (100м)</column>
            <column name="description">Полипропиленовая труба для систем водоснабжения</column>
            <column name="price" valueNumeric="40.00"/>
            <column name="old_price" valueNumeric="50.00"/>
            <column name="brand">Lammin</column>
            <column name="sku">PPR-PN20-20-100-2</column>
            <column name="specifications">{"diameter": "20 мм", "pressure": "PN20", "length": "100м", "material": "PPR"}</column>
            <column name="is_active" valueBoolean="true"/>
            <column name="is_featured" valueBoolean="false"/>
            <column name="category_id" valueNumeric="9"/>
        </insert>

        <insert tableName="products">
            <column name="created_at" valueComputed="NOW()"/>
            <column name="updated_at" valueComputed="NOW()"/>
            <column name="name">Труба PPR PN25 арм. стеклов. 20x3,4 (100м)</column>
            <column name="description">Армированная полипропиленовая труба со стекловолокном</column>
            <column name="price" valueNumeric="40.00"/>
            <column name="old_price" valueNumeric="50.00"/>
            <column name="brand">Lammin</column>
            <column name="sku">PPR-PN25-20-100-2</column>
            <column name="specifications">{"diameter": "20 мм", "pressure": "PN25", "length": "100м", "material": "PPR", "reinforcement": "стекловолокно"}</column>
            <column name="is_active" valueBoolean="true"/>
            <column name="is_featured" valueBoolean="false"/>
            <column name="category_id" valueNumeric="9"/>
        </insert>

    </changeSet>

</databaseChangeLog>
